<html>

<head>
	<meta charset="UTF-8">
	<link href="style.css" rel="stylesheet">
</head>

<body>
	<div class="all">
	<main class="head">
		<h3>MEGA ULTIMATE MACHINA TIMER CALCULATOR ADVENTURE</h3>
		<!-- <p>42 Rush 00</p> -->
	</main>
	<div class="corps">
		<div class="param">
			<label for="prepaTime">Temps pour se preparer :</label>
			<input id="prepaTime" name="prepa" value="5" type="number">
			<label for="prepaTime">secondes</label><br><br>
			<label for="codeTime">Temps pour coder :</label>
			<input id="codeTime" name="code" value="30" type="number">
			<label for="codeTime">secondes</label>
			<br><br>
			<div>
				<button id="startStopBtn" class="button">Start / Stop</button>
				<button id="breakBtn" class="button">Pause</button>
			</div>
		</div>
			<p id="prepaDivTimer" class="truc">
				<span>
					Temps restant pour se preparer :
				</span>

				<strong><span id="leftPreparationTime">
					5.0
				</span></strong>
			</p>
		
		<!-- <p id="leftCodeTime">Temps restant pour code :</p> -->
		<p id="codeDivTimer" class="truc">
			<span>
				Temps restant pour coder :
			</span>

			<strong><span id="leftCodeTime">
				30.0
			</span></strong>

			
		</p>

		<p id="totalDivTimer" class="truc">
			<span>
				Temps total :
			</span>

			<strong><span id="totalCodeTime">
				0.0
			</span></strong>

			
		</p>


	</div>
</div>
	<script>
		document.addEventListener("DOMContentLoaded", function (event) {
		var startStopBtn = document.getElementById("startStopBtn");
		var breakBtn = document.getElementById("breakBtn");
		var timerStarted = false;
		var timerPause = false;
		var start = 0;
		var timerInterval = 0;
		var soundStarted = false;
		var prepaTime = document.getElementById("prepaTime").value;
		var codeTime = document.getElementById("codeTime").value;
		var prepaDivTimer = document.getElementById("prepaDivTimer");
		var codeDivTimer = document.getElementById("codeDivTimer");
		var totalCodeTime = document.getElementById("totalCodeTime");



		var currentTimer = 0;
		breakBtn.addEventListener('click', () => {timerPause = !timerPause});
		startStopBtn.addEventListener('click', () => {
			if (timerStarted == true)
			{
				clearInterval(timerInterval)
				timerStarted = false;
				prepaDivTimer.style.backgroundColor = "#ffcb77";
				codeDivTimer.style.backgroundColor = "#ffcb77";

			}
			else
			{
				timerPause = false;
				timerStarted = true;
				currentTimer = 0;
				prepaTime = parseInt(document.getElementById("prepaTime").value,10);
				codeTime = parseInt(document.getElementById("codeTime").value, 10);
				timerInterval = setInterval(function(){

					console.log("prepatime: ",prepaTime);
					console.log("codetime: ",codeTime);
					console.log("modulo value :", (currentTimer % (prepaTime + codeTime)));
					if (currentTimer % (prepaTime + codeTime) < prepaTime)
					{
					let leftPreparationTime = document.getElementById("leftPreparationTime");
						leftPreparationTime.innerHTML = parseFloat(prepaTime - (currentTimer % (prepaTime + codeTime))).toFixed(1);
						leftCodeTime.innerHTML = "0.0"
						if (prepaTime - (currentTimer % (prepaTime + codeTime)) < 5)
						prepaDivTimer.style.backgroundColor = "#fe6d73";
						else
						{
							soundStarted = false;
							prepaDivTimer.style.backgroundColor = "#17c3b2";
						}
						codeDivTimer.style.backgroundColor = "#ffcb77";
					}
					else
					{
						let leftCodeTime = document.getElementById("leftCodeTime");
						leftCodeTime.innerHTML = parseFloat((codeTime - (currentTimer % (prepaTime + codeTime) - prepaTime))).toFixed(1);
						leftPreparationTime.innerHTML = "0.0"
						if (codeTime - (currentTimer % (prepaTime + codeTime) - prepaTime) < 5)
						{
							if (soundStarted == false)
							{
								var audio = new Audio('audio_file.mp3');
								audio.play();
							}
							codeDivTimer.style.backgroundColor = "#fe6d73";
							soundStarted = true;
						}
						else
						{
							soundStarted = false;
							codeDivTimer.style.backgroundColor = "#17c3b2";
						}
						prepaDivTimer.style.backgroundColor = "#ffcb77";
					}
					if (timerPause == false)
					{
						currentTimer+=0.1;
					}
					totalCodeTime.innerHTML = parseFloat((currentTimer)).toFixed(1)
				},100);
			}
		});


	});
	</script>

</body>

</html>